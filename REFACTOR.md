We are burning the old JavaScript codebase to the ground and building a new, industrial-grade simulation engine from the ashes. We will use the "Google Enterprise Stack" (Angular + Go + gRPC) to create a system that looks exactly like your Cyberpunk UI but runs with the precision of a flight simulator.The Architecture: "The Google Stack"Frontend: Angular 19 (Stable/Next) using Signals for zero-latency reactivity.Backend: Go (Golang) 1.23 for concurrent physics/math processing.Protocol: gRPC (Protobuf) for binary data contracts (replacing JSON).Visuals: Apache ECharts (Canvas) for rendering 60fps simulations.Phase 0: The Foundation (The Monorepo)Goal: Establish the folder structure and the strict Data Contracts.Directory Setup: Create a workspace that houses both the client and server.Plaintext/physiosim-enterprise
├── /proto          # The Single Source of Truth (API definitions)
├── /backend        # Go Server (The Engine)
├── /frontend       # Angular Client (The Cockpit)
└── /tools          # Build scripts / Makefile
The Contract (physiosim.proto):We define the data structures once.Action: Define message Compound, message Cycle, and service SimulationEngine.Math Upgrade: Include fields for ka (Absorption Rate) and ke (Elimination Rate) in the definitions now, so the math works later.Phase 1: The Engine (Go Backend)Goal: Build the math solver that runs the Bateman and Hill equations.Initialize Go Module: Set up the server shell.Implement the "Science" Package:Create pkg/pharmacokinetics/bateman.go.Task: Implement the Bateman Function (Double-Exponential) to model the "ramp up" of esters accurately.Task: Implement Michaelis-Menten logic for the toxicity saturation curves.The Solver Loop:Create the logic that sums overlapping curves (Superposition).Optimization: Use Go's goroutines to prepare for the Monte Carlo solver (calculating 10,000 cycles in parallel).gRPC Server: Expose the Simulate() function via a gRPC port (e.g., :50051).Phase 2: The Cockpit (Angular Frontend)Goal: Re-create the Cyberpunk UI using modern components.Initialize Angular 19: Set up a strict-mode project.The "Asset Heist" (Copying the Look):Fonts: Copy your sci-fi fonts (JetBrains Mono, Orbitron) to /assets.CSS: Port your existing color variables (--neon-cyan, --void-black) into the global styles.scss.Component Architecture:Left Panel: ActiveMixtureComponent. Re-build the "Tactical Dropdown" here.Center Panel: SimulationChartComponent. Initialize ECharts here.Right Panel: TelemetryHudComponent. Re-build the Radar/Gauge charts here.State Management:Use Angular Signals (input(), computed()) to manage the state. Do not use Redux/NgRx yet; Signals are faster for this use case.Phase 3: The Connection (gRPC-Web)Goal: Make the Frontend talk to the Backend.Generate Clients: Use protoc to generate the TypeScript client code from your .proto file.The Proxy: Since browsers can't speak raw gRPC, set up an Envoy Proxy (Docker container) or use the Go library improbable-eng/grpc-web to wrap the server.Wiring: Connect the Angular Signal (User Input) $\to$ gRPC Client $\to$ Go Backend $\to$ EChart.Phase 4: The Feature Migration (Feature Parity)Goal: Ensure everything the old app did, the new app does better.The "Tactical Dropdown": Implement the search logic for compounds.The Slider Logic: Re-implement the hybrid "Input + Slider" control. Ensure dragging it triggers the gRPC stream instantly.The Optimization Panel: Build the "Text-Only" Mode Selector we designed. Connect it to the Go Monte Carlo solver.Phase 5: The Scientific Validation (QA)Goal: Verify the new math is actually better.The "Spike" Test: Plot Testosterone Propionate vs. Testosterone Undecanoate.Pass: Propionate spikes fast (Day 1). Undecanoate humps slowly (Day 5-7).Fail: Both look like simple decay curves.The "Crash" Test: Input a massive dose (2000mg Orals).Pass: The Toxicity score skyrockets exponentially (Michaelis-Menten saturation).Fail: Toxicity scales linearly.The "Ignition" PromptHere is the first instruction to give the LLM to start Phase 0 and Phase 1. This sets up the workspace and the backend.Prompt:"We are initiating Operation Iron Phoenix. We are building the PhysioSim Enterprise platform from scratch.Architecture:Root: Monorepo structure.Backend: Go (Golang) 1.23.Frontend: Angular 19.Communication: gRPC (Protobuf).Step 1: Define the Contract (Phase 0)Create a file named proto/physiosim/v1/engine.proto.It must define:enum EsterType (Enanthate, Propionate, etc.).message Compound (ID, Name, Dosage, EsterType, Absorption_K, Elimination_K).message SimulationRequest (List of Compounds, Duration).message DataPoint (Day, SerumConcentration, AnabolicScore, ToxicityScore).service SimulationEngine with a single RPC: RunSimulation.Step 2: Initialize the Backend (Phase 1)Create a Go module (backend/).Generate the Go structs from the .proto file.Create pkg/math/bateman.go. Implement the Bateman Function for pharmacokinetics:func CalculateConcentration(dose float64, ka float64, ke float64, time float64) float64Set up a basic gRPC server in cmd/server/main.go that listens on port 50051.Output: Provide the .proto file content and the Go bateman.go logic."