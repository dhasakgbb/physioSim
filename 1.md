# Outstanding Work After Stack Engine / Cycle Workspace Merge

The shared stack brain, guard-rail metadata, simple-vs-lab toggle, and cycle storage are in place. What’s left now is largely UI/UX debt from the earlier outline plus a bit of polish to make those new data hooks visible.

## 1. Chart-Level Guardrails
- ✅ `evaluateCompoundResponse` now feeds `value + ci + meta` into DoseResponse / Oral charts, plateau zones fade at the derived `plateauDose`, evidence caps draw dashed red segments, and `HoverAnalyticsTooltip` mirrors the guardrail copy. InteractionHeatmap sliders also read `pairEvaluation.byCompound.meta`, clamp in simple mode, and show the same plateau/evidence pills.
- ✅ `CustomLegend` now forwards hover events into the hero charts, dims non-hovered compounds, and shows unit-aware plateau/evidence cap badges so users can see where guardrails land without hunting the curves. The sticky interaction summary bar also carries a compact guardrail badge that flips between "nominal", "plateau", and "outside evidence" states per pair.

## 2. Interaction Tab Layout & Simple Mode
- ✅ Slider callouts now read `pairEvaluation.byCompound.meta`, clamp doses beyond the evidence cap, and show the same plateau / “outside evidence” chips that appear on the charts. Simple mode also displays the “Lab mode unlocks overrides” hint when sliders hit the cap.
- ✅ Sticky anchor nav tracks the major chunks (matrix → controls → metrics → charts → surfaces → optimizers), pair selection auto-scrolls into the controls, recommendation cards call back into the sliders, and simple mode now locks the evidence slider plus hides/lazily resets lab-only tooling. Lab mode restores the full sweep/surface/optimizer stack, so the tab no longer reads as one giant column.

## 3. Injectables / Orals Tab Compression
- ✅ Tabs now follow the “Profile status → sticky control strip → hero chart → shared context drawer” stack: `ProfileStatusBar` replaced the inline panel (with a modal editor + lab toggle), `ChartControlBar` is the thin sticky strip with a filter indicator, the chart + legend share one hero card, and the “Need context?” drawer consolidates Quick Guide / Scenarios / Evidence Tier / EvidencePanel.
- ✅ README + screenshots now cover the compressed mode toggle, the status bar shows the unsaved-profile badge + quick save action, and the Evidence drawer lazy-loads `EvidencePanel` behind a Suspense fallback so the heavy cards hydrate only after the user expands the section.

## 4. Cycle Workspace Polish
- ✅ The comparison card now emits the friendly narrative (“adds +0.8 cosmetic benefit… driven by …”), and both the orientation bar and saved-cycle grid surface cycle name, preset tag, and updated timestamp so there’s no guessing which record is active.
- ✅ Ancillary/monitoring deltas now flow into the narrative copy (with unit-aware cost callouts), and `src/test/stackBuilder.test.jsx` gained regression coverage for both upgrades and reductions so we catch future copy drift automatically.

## 5. Test / UX Clean-Up
- ✅ `src/test/setup.js` stubs `localStorage` + `scrollTo`, StackBuilder tests render through `renderWithAct`, and the InteractionHeatmap snapshot is updated. `npx vitest run src/test/stackBuilder.test.jsx src/components/__tests__/InteractionHeatmap.test.jsx` now passes cleanly.
- ✅ README now calls out the Vitest shims plus interaction testing guidelines (“always await user events, prefer renderWithAct”), so contributors know how to avoid reintroducing act warnings before they touch interaction-heavy suites.
