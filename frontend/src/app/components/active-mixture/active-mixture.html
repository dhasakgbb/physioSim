<section class="panel-header">
	<div class="panel-header__title">
		<p class="eyebrow">Stack composer</p>
		<h2>Active mixture</h2>
	</div>

	<button class="neon-button" type="button" (click)="triggerRun()" [disabled]="loading">
		<span>{{ loading ? 'Solvingâ€¦' : 'Pulse solver' }}</span>
		<span class="pulse-indicator" aria-hidden="true"></span>
	</button>
</section>

<section class="duration-tile">
	<div>
		<p class="eyebrow">Mission duration</p>
		<div class="duration-value">
			<span>{{ durationDays }}</span>
			<small>days</small>
		</div>
	</div>
	<input
		type="range"
		class="duration-slider"
		[min]="durationRange.min"
		[max]="durationRange.max"
		[value]="durationDays"
		(input)="onDurationChange($event)"
	/>
	<div class="duration-scale">
		<span>{{ durationRange.min }}d</span>
		<span>{{ durationRange.max }}d</span>
	</div>
</section>

<section class="compound-deck" *ngIf="compounds.length; else emptyState">
	<article class="compound-card" *ngFor="let compound of compounds; trackBy: trackByCompound">
		<header class="compound-card__header">
			<div>
				<p class="eyebrow">{{ compound.id | uppercase }}</p>
				<h3>{{ compound.name }}</h3>
			</div>
			<div class="dosage-chip">{{ compound.dosageMg }} mg</div>
		</header>

		<div class="dosage-controls">
			<input
				type="range"
				min="0"
				max="400"
				step="5"
				[value]="compound.dosageMg"
				(input)="onDosageSliderChange(compound.id, $event)"
			/>
			<input
				type="number"
				min="0"
				max="400"
				step="5"
				[value]="compound.dosageMg"
				(input)="onDosageInputChange(compound.id, $event)"
			/>
		</div>

		<div class="compound-card__meta">
			<div>
				<span class="label">Ester</span>
				<span>{{ formatEster(compound.ester) }}</span>
			</div>
			<div>
				<span class="label">Absorption k<sub>a</sub></span>
				<span>{{ compound.absorptionK | number: '1.2-2' }}</span>
			</div>
			<div>
				<span class="label">Elimination k<sub>e</sub></span>
				<span>{{ compound.eliminationK | number: '1.2-2' }}</span>
			</div>
		</div>
	</article>
</section>

<ng-template #emptyState>
	<div class="empty-state">
		<p>No active injectables configured.</p>
		<button type="button" class="ghost" (click)="refreshRequested.emit()">Load defaults</button>
	</div>
</ng-template>
